import{ak as M,G as q,a1 as U,H as b,u as B,c as w,b as i,j as f,k as y,z as _,a as $,i as g,t as r,P as D,o as h,E as v,C as E}from"./rUxWeFGW.js";import{u as G}from"./IrCqCeJw.js";import{F as C,a as P,b as F,S as T,W as R,c as S,d as W,D as A}from"./CvT78Spi.js";import{f as L}from"./BkRSp81T.js";import{p as I,w as H}from"./CxKpLf07.js";import{F as N}from"./7-ntfYCI.js";import"./DysYrq2t.js";import"./11RS6YOe.js";import"./CqxP3l68.js";import"./Dm9fix82.js";import"./DO4bYi6O.js";import"./DvJGoVIP.js";const Q={class:"section section-white free-tool-section"},j={class:"container"},J={key:0},V={class:"progress-bar-content"},Y={key:1},z={key:2},K={class:"winner-header"},X=i("br",null,null,-1),Z={key:3,class:"fb-free-tool-information"},x=i("br",null,null,-1),ee=i("br",null,null,-1),te={name:"giveaway",components:{ProgressBar:I,FreeToolScannerInput:F,SweepTakes:T,FreeToolsSteps:C,FreeToolHeader:P,FreeToolInformation:S,FacebookPost:L,WinnerPersonCard:H,FreeToolModals:W,Determining:A,WinnerResults:R,FAQ:N},data(){return{MAX_WINNER_LIMIT:25,step:1,url:"",minimumMention:1,NumberOfWinner:1,response:{},comments:[],winners:[],is_limited:!0,loading:!1,post_data:{created_time:""},post_id:"",faqs:[{question:this.$t("fb-faq-header-1"),answer:this.$t("fb-faq-desc-1")},{question:this.$t("fb-faq-header-2"),answer:this.$t("fb-faq-desc-2")},{question:this.$t("fb-faq-header-3"),answer:this.$t("fb-faq-desc-3")},{question:this.$t("fb-faq-header-4"),answer:this.$t("fb-faq-desc-4")},{question:this.$t("fb-faq-header-5"),answer:this.$t("fb-faq-desc-5")}],post_token:""}},mounted(){this.checkDailyLimit(),this.checkQueryParams()},methods:{fetchComments:async function(){let n=v(),a=0;const o=async()=>{try{const{data:t,status:c,message:s,error:l}=await $fetch(n.public.API_URL+"giveaway/v2/check",{method:"POST",body:JSON.stringify({token:this.post_token})});if(c){if(!t.progress)for(let d=0;d<t.winners.length;d++)this.winners.push({image:t.winners[d].avatar,username:t.winners[d].username});return!0}else return!1}catch{}};await(async()=>{for(;a<60;){try{let t=await o();t&&this.winners.length===0?a++:!t&&this.winners.length===0?a=a+12:a=60}catch{}await this.sleep(2e3)}})()},fetchWinners:async function(n){let a=v();try{let{data:o,status:u}=await $fetch(a.public.API_URL+"giveaway/v2/options",{method:"PUT",body:JSON.stringify({minimum_mention:n.mention,number_of_winner:n.winners>=50?this.commentCount<=50?this.commentCount:49:n.winners>this.commentCount?this.commentCount:n.winners,token:this.post_token})});if(u&&!o.progress)for(let t=0;t<o.winners.length;t++)this.winners.push({image:o.winners[t].avatar,username:o.winners[t].username});return u}catch(o){return console.warn(o),!1}},sleep:function(n){return new Promise(a=>setTimeout(a,n))},findWinners:async function(){try{this.loading=!0;let[n]=await Promise.all([this.fetchWinners({mention:this.minimumMention,winners:this.NumberOfWinner,token:this.post_token})]);this.isGiveawayComplete=n,this.winners.length>0&&this.isGiveawayComplete?(this.loading=!1,this.step=3,await this.setCookie()):(this.url="",this.temp_url="",this.loading=!1,this.post_data={created_time:""},this.share_url_error=!1,this.winners=[],this.step=1)}catch{}finally{this.comments=[]}try{window.dataLayer.push({event:"giveaway-facebook_success_web"})}catch(n){console.warn("GTM warn: ",n)}},scanPost:async function(n){if(this.share_url_error=!1,this.temp_url="",this.url.indexOf("https://www.instagram")!==-1)return this.showInstagramModal(),!1;if(!n&&(n||this.loading))return;this.loading=!0;let a=await this.getCookie("utm_campaign")||null,o=await this.getCookie("utm_source")||null,u=v();const t=async()=>{try{let s={post_url:this.url};o&&(s.utm_source=o),a&&(s.utm_campaign=a);const{data:l,status:d}=await $fetch(u.public.API_URL+"giveaway/v2/start",{method:"POST",body:JSON.stringify(s)},!1);return l}catch(s){throw s}},c=async()=>{let s=0;for(;s<15;)try{let l=await t();if(l.details.comment_count){if(l.details)return this.commentCount=l.details.comment_count,l;s++}else return s=15,this.empty_comment=!0,l}catch{s++}throw new Error(`Failed to fetch data from ${url} after 15 attempts`)};try{const[s]=await Promise.all([c()]);this.post_data={created_time:s.details.created_time||"2024-08-08T22:00:00.000Z",description:s.details.post_caption,image:s.details.post_img,avatar:s.details.owner.avatar,username:s.details.owner.username.charAt(0).toUpperCase()+s.details.owner.username.slice(1)},this.post_token=s.token,this.step=2,this.loading=!1}catch{console.warn("can't load comments"),this.loading=!1}},checkDailyLimit:function(){this.is_limited=this.getCookie("fb")!=="1"},setCookie:async function(){let n=new Date;n.setTime(n.getTime()+24*3600*1e3),document.cookie="fb=1; expires="+n+";",document.cookie="use_made_giveaway=FB_GIVEAWAY;domain=.wask.co;expires="+n*30+";"},getCookie:function(n){let a=n+"=",u=decodeURIComponent(document.cookie).split(";");for(let t=0;t<u.length;t++){let c=u[t];for(;c.charAt(0)===" ";)c=c.substring(1);if(c.indexOf(a)===0)return c.substring(a.length,c.length)}return""},loginRequest:function(){this.$refs.modals.login=!0},registerRequest:function(){this.$refs.modals.register=!0},checkQueryParams:function(){let n=(this._.provides[D]||this.$route).query.scan_url;n&&(this.url=n,this.scanFacebookPost())},showInstagramModal:function(){this.$refs.modals.instagram=!0,this.$refs.modals.scan_url=this.url}},watch:{step:function(n){n===2&&window.scrollTo({top:0,behavior:"smooth"})},loading:function(){window.scrollTo({top:0,behavior:"smooth"})}}},de=Object.assign(te,{async setup(n){let a,o;const u=M("lang");u.value=u.value||"en";const t=q();let s=U().query.lang;const{setLocale:l}=q(),d=[{question:"fb-faq-header-1",answer:"fb-faq-desc-1"},{question:"fb-faq-header-2",answer:"fb-faq-desc-2"},{question:"fb-faq-header-3",answer:"fb-faq-desc-3"},{question:"fb-faq-header-4",answer:"fb-faq-desc-4"},{question:"fb-faq-header-5",answer:"fb-faq-desc-5"}];function O(){let e=[];return d.forEach(m=>{let k={"@type":"Question",name:t.t(m.question),acceptedAnswer:{"@type":"Answer",text:t.t(m.answer)}};e.push(k)}),e}return s?([a,o]=b(()=>l(s)),await a,o(),u.value=s):([a,o]=b(()=>l(u.value)),await a,o()),t.locale.value==="tr"&&([a,o]=b(()=>l("en")),await a,o()),t.locale.value==="en"||t.locale.value==="de"||t.locale.value==="es"||t.locale.value==="fr"||t.locale.value==="ru"||([a,o]=b(()=>l("en")),await a,o()),G({title:t.t("facebook-giveaway-title"),description:t.t("facebook-giveaway-desc"),"og:title":t.t("facebook-giveaway-title"),"og:description":t.t("facebook-giveaway-desc")}),B({script:[{type:"application/ld+json",innerHTML:JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"WASK",item:"https://www.wask.co"},{"@type":"ListItem",position:2,name:t.t("facebook-giveaway-title-breadcrumb"),item:"https://www.wask.co/facebook-comment-picker-giveaway"+(t.locale.value==="en"?"":"?lang="+t.locale.value)}]})},{type:"application/ld+json",innerHTML:JSON.stringify({"@context":"https://schema.org","@type":"FAQPage",mainEntity:O()})}],htmlAttrs:{lang:t.locale},link:[{rel:"canonical",href:"https://www.wask.co/facebook-comment-picker-giveaway"}],meta:[{name:"og:url",content:"https://www.wask.co/facebook-comment-picker-giveaway"+(t.locale.value==="en"?"":"?lang="+t.locale.value)},{name:"og:image",content:"https://www.wask.co/og-image.png"}]}),(e,m)=>{const k=E;return h(),w("div",Q,[i("div",j,[f(C,{step:e.step,source:"facebook"},null,8,["step"]),e.step===1?(h(),w("div",J,[f(P,null,{default:y(()=>[i("h1",null,r(e.$t("Free Facebook Comment Picker and Giveaway Tool")),1),i("p",null,r(e.$t("facebook-giveaway-subtitle")),1),f(k,{src:"/img/free-tool/facebook-logo.svg",width:"50",height:"50",alt:"facebook"})]),_:1}),e.loading?(h(),_(I,{key:0,class:"mb-3"},{default:y(()=>[i("div",V,r(e.$t("Getting your comments... Please wait!")),1)]),_:1})):$("",!0),f(F,{url:e.url,"onUpdate:url":m[0]||(m[0]=p=>e.url=p),onScanForUrl:e.scanPost,placeholder:"Enter Your Facebook Post Url"},null,8,["url","onScanForUrl"])])):e.step===2?(h(),w("div",Y,[e.loading?(h(),_(A,{key:1})):(h(),_(T,{key:0,"minimum-mention":e.minimumMention,"onUpdate:minimumMention":m[1]||(m[1]=p=>e.minimumMention=p),"number-of-winner":e.NumberOfWinner,"onUpdate:numberOfWinner":m[2]||(m[2]=p=>e.NumberOfWinner=p),comments:e.commentCount,onFindWinners:e.findWinners},null,8,["minimum-mention","number-of-winner","comments","onFindWinners"]))])):(h(),w("div",z,[i("h3",K,[g(r(e.$t("Congratulations!"))+" ",1),X,g(" "+r(e.$t("Here are the winners")),1)]),f(L,{info:e.post_data.created_time,description:e.post_data.description,image:e.post_data.image,avatar:e.post_data.avatar,username:e.post_data.username},null,8,["info","description","image","avatar","username"]),f(R,{type:"facebook",winners:e.winners,"show-first":e.is_limited,onLoginRequest:e.loginRequest,onRegisterRequest:e.registerRequest},null,8,["winners","show-first","onLoginRequest","onRegisterRequest"])])),e.step===1?(h(),w("div",Z,[f(S,null,{default:y(()=>[i("h2",null,r(e.$t("facebook-information-header-1")),1),i("p",null,[i("strong",null,r(e.$t("Step 1"))+":",1),g(" "+r(e.$t("facebook-information-paragraph-1")),1)]),i("p",null,[i("strong",null,r(e.$t("Step 2"))+":",1),g(" "+r(e.$t("facebook-information-paragraph-1-2")),1)]),i("p",null,[i("strong",null,r(e.$t("Step 3"))+":",1),g(" "+r(e.$t("facebook-information-paragraph-1-3")),1)]),x,i("h2",null,r(e.$t("facebook-information-header-2")),1),i("p",null,r(e.$t("facebook-information-paragraph-2")),1),ee,i("h2",null,r(e.$t("facebook-information-header-3")),1),i("p",null,r(e.$t("facebook-information-paragraph-3")),1)]),_:1})])):$("",!0),f(W,{ref:"modals"},null,512),f(N,{faqs:e.faqs,header:e.$t("Frequently Asked Questions")},null,8,["faqs","header"])])])}}});export{de as default};
